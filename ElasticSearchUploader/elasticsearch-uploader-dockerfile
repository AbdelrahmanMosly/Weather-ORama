# Use a base image with Java and inotify-tools installed
FROM eclipse-temurin:17-jre-alpine

# Install inotify-tools
RUN apk update && apk add --no-cache bash && apk add inotify-tools

# Set the working directory in the container
WORKDIR /app

# Set the environment variable for the Parquet files directory
ENV PARQUET_FILES_DIR=/home/parquet-files

# Create the directory for Parquet files
RUN mkdir -p $PARQUET_FILES_DIR

# Copy the JAR file and Bash script into the container
COPY ./target/ElasticSearchUploader.jar  ./ElasticSearchUploader.jar
COPY watch_directory.sh ./

# Make the Bash script executable
RUN chmod +x watch_directory.sh

# Command to run when the container starts
CMD ["/bin/bash", "-c", "./watch_directory.sh"]

